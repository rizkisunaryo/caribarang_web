<div style="display:none;" id="angularBridge"></div>

<style type="text/css">
	@media all and (min-width: 768px) {
		div.item-container {
			width: 18.7%;
		}
	}
</style>

<div class="container">
	<div class="jumbotron">
		<h1>CariBarang</h1>
		<p style="color:blue;">Mau belanja online? Cari aja di sini!</p>
	</div>

	<div class="row text-right" style="margin-right:5px; margin-bottom:20px;">
		<div id="fb-login-div" style="display:none;">
			<div id="fb-root"></div>
			<div class="fb-login-button" data-max-rows="1" data-size="large" data-show-faces="false" data-auto-logout-link="false" onlogin="checkLoginState();"></div>
		</div>
		<div id="user-drop-down" style="margin-top:-9px; cursor:pointer; float:right; display:none;">
			<ul class="nav nav-pills left">
				<li class="dropdown active span8">
					<a class="dropdown-toggle" id="inp_impact" data-toggle="dropdown">
						<span id="user-full-name"></span>&nbsp;<span class="caret"></span>
					</a>
					<ul ID="divNewNotifications" class="dropdown-menu" style="cursor:pointer;">
						<li><a onclick="logoutFB();">Log Out</a></li>
					</ul>
				</li>
			</ul>
		</div>
	</div>

	<div class="row">
		<div class="col-sm-3"></div>
		<div class="col-sm-6">
			<form role="form" method="GET" id="form">
				<select class="form-control" id="form_category" name="form_category">
					<option ng-repeat="category in categories | orderBy:'-CategoryOrder'" value="{{category.Category}}">{{category.Label}}</option>
				</select><br />
				<input type="text" class="form-control" id="form_keyword" name="form_keyword" placeholder="Kata kunci"><br />
				<input type="tel" class="form-control" ng-model="minPrice" placeholder="Harga minimum" onkeypress="return isNumberKey(event);" onkeyup="this.value=numberWithCommas(this.value);"><br />
				<input type="tel" class="form-control" ng-model="maxPrice" placeholder="Harga maximum" onkeypress="return isNumberKey(event);" onkeyup="this.value=numberWithCommas(this.value);"><br />
				<button type="submit" class="btn btn-default">C A R I</button>
			</form>
		</div>
		<div class="col-sm-3"></div>
	</div>

	<!-- ==============
	SUGGESTIONS SECTION
	=============== -->
	<div class="row" id="suggestions-title" style="padding-left:10px;"></div>
	<div class="row" id="suggestions-row-1"></div>
	<div ng-repeat="suggestion in suggestions">
		<div class="item-container text-center">
			<span style="font-weight: bold;">{{suggestion._source.Source}}</span><br>
			<div style="text-overflow:ellipsis; white-space: nowrap; overflow: hidden; width: 100%">
				<a onmousedown="popularSave(\'' + v.Uri + '\')" href="' + v.Uri + '" target="_blank">{{suggestion._source.Name}}</a>
			</div>
			<span style="font-size: 1.5em;">{{suggestion._source.Price}}</span><br>
			<div class="cropped-image-container">
				<a href="{{suggestion._source.Uri}}" target="_blank">
					<img class="cropped-image" style="max-width:100%;" src="{{suggestion._source.ImageUri}}" />
				</a>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		function fbLoginSuccessCallback() {
			angular.element(document.getElementById('angularBridge')).scope().getSuggestions({
					Id: id,
					Token: token,
					LoginType: 'fb',
					Size: '5'
				});
			// $.ajax({
			// 	url: API_SERVER_URI + '/api/suggestions/list',
			// 	type: 'POST',
			// 	dataType: 'json',
			// 	success: function(data) {
			// 		if (typeof data.Message !== 'undefined' && data.Message != null && data.Message != "") {
			// 			return;
			// 		};
			// 		if (data.hits.hits.length < 1) {
			// 			return;
			// 		};

			// 		$('#suggestions-title').html('<hr><h3>SUGGESTIONS</h3>');
			// 		var suggestionsRow1Html = '';
			// 		$.each(data.hits.hits, function(i, e) {
			// 			var v = e._source;
			// 			var html = '<div class="item-container text-center">
								// <span style="font-weight: bold;">' + v.Source + '</span><br>
								// <div style="text-overflow:ellipsis; white-space: nowrap; overflow: hidden; width: 100%">
								// 	<a onmousedown="popularSave(\'' + v.Uri + '\')" href="' + v.Uri + '" target="_blank">' + v.Name + '</a>
								// </div>
								// <span style="font-size: 1.5em;">' + numberWithCommas(String(v.Price)) + '</span><br>
								// <div class="cropped-image-container">
								// 	<a onmousedown="popularSave(\'' + v.Uri + '\')" href="' + v.Uri + '" target="_blank">
								// 		<img class="cropped-image" style="max-width:100%;" src="assets/img/no-image.png" id="suggestions-preload-image_' + i + '" />
								// 	</a>
								// </div>
			// 				'</div>';
			// 			if (i <= 4) {
			// 				suggestionsRow1Html += html;
			// 			}

			// 			var img = new Image();
			// 			img.onload = function() {
			// 				$('#suggestions-preload-image_' + i).attr('src', v.ImageUri);
			// 			}
			// 			img.src = v.ImageUri;
			// 		});
			// 		$('#suggestions-row-1').html(suggestionsRow1Html);
			// 	}.bind(this),
			// 	error: function(xhr, status, err) {
			// 		// EMPTY
			// 	}.bind(this),
			// 	data: JSON.stringify({
			// 		Id: id,
			// 		Token: token,
			// 		LoginType: 'fb',
			// 		Size: '5'
			// 	})
			// });
		}
	</script>
</div>



